{% extends 'layout.html' %}

{% block content %}
    <h1><i class="fas fa-shopping-cart me-3"></i>Your Cart</h1>

    {% if cart_items %}
        <div class="row">
            <div class="col-md-8">
                {% for item in cart_items %}
                <div class="card mb-3">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-8">
                                <h5 class="card-title"><i class="fas fa-cube me-2"></i>{{ item.product.name }}</h5>
                                <p class="card-text">{{ item.product.description }}</p>
                                <p class="card-text"><i class="fas fa-rupee-sign me-1"></i>Price: ₹{{ item.product.price }}</p>
                                <p class="card-text"><i class="fas fa-tag me-1"></i>Category: {{ item.product.category.name }}</p>
                            </div>
                            <div class="col-md-4">
                                <form action="{{ url_for('main.update_cart', cart_id=item.id) }}" method="post" class="d-inline">
                                    <div class="input-group mb-2">
                                        <span class="input-group-text"><i class="fas fa-hashtag"></i></span>
                                        <input type="number" class="form-control" name="quantity" value="{{ item.quantity }}" min="0" max="{{ item.product.quantity }}">
                                        <button class="btn btn-outline-secondary" type="submit"><i class="fas fa-sync-alt me-1"></i>Update</button>
                                    </div>
                                </form>
                                <form action="{{ url_for('main.remove_from_cart', cart_id=item.id) }}" method="post" class="d-inline">
                                    <button type="submit" class="btn btn-danger btn-sm"><i class="fas fa-trash me-1"></i>Remove</button>
                                </form>
                                <p class="mt-2"><strong><i class="fas fa-calculator me-1"></i>Subtotal: ₹{{ item.quantity * item.product.price }}</strong></p>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title"><i class="fas fa-receipt me-2"></i>Order Summary</h5>
                        <p class="card-text"><i class="fas fa-boxes me-1"></i>Total Items: {{ cart_items|length }}</p>
                        <p class="card-text"><strong><i class="fas fa-rupee-sign me-1"></i>Total: ₹{{ total }}</strong></p>
                        <form action="{{ url_for('main.buy') }}" method="post">
                            <button type="submit" class="btn btn-success w-100"><i class="fas fa-credit-card me-1"></i>Buy Now</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    {% else %}
        <p><i class="fas fa-shopping-cart me-1"></i>Your cart is empty. <a href="{{ url_for('main.index') }}"><i class="fas fa-arrow-right me-1"></i>Continue shopping</a>.</p>
    {% endif %}
{% endblock %}